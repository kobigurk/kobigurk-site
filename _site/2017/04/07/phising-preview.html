<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Phishing in the age of preview</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
		<link rel="stylesheet" href="/assets/css/side-menu.css">
		<link rel="stylesheet" href="/assets/css/styles.css">
    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Phishing in the age of preview</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Phishing in the age of preview" />
<meta name="author" content="Kobi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Link previews are convenient. Implemented inside messaging platforms, they allow you to see the summary of a link a friend sent you without actually opening it, giving you the ability to decide whether it’s important or interesting enough to open it in a browser." />
<meta property="og:description" content="Link previews are convenient. Implemented inside messaging platforms, they allow you to see the summary of a link a friend sent you without actually opening it, giving you the ability to decide whether it’s important or interesting enough to open it in a browser." />
<link rel="canonical" href="http://localhost:4000/2017/04/07/phising-preview.html" />
<meta property="og:url" content="http://localhost:4000/2017/04/07/phising-preview.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-04-07T00:00:00+03:00" />
<script type="application/ld+json">
{"description":"Link previews are convenient. Implemented inside messaging platforms, they allow you to see the summary of a link a friend sent you without actually opening it, giving you the ability to decide whether it’s important or interesting enough to open it in a browser.","author":{"@type":"Person","name":"Kobi"},"@type":"BlogPosting","url":"http://localhost:4000/2017/04/07/phising-preview.html","headline":"Phishing in the age of preview","dateModified":"2017-04-07T00:00:00+03:00","datePublished":"2017-04-07T00:00:00+03:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2017/04/07/phising-preview.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet"
				href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">

  </head>
  <body>
    <div id="layout">
			<a href="#menu" id="menuLink" class="menu-link"><span></span></a>

<div id="menu">
	<div class="pure-menu">
		<a class="pure-menu-heading" href="#">Kobi Gurkan</a>
		<ul class="pure-menu-list">
			
			<li class="pure-menu-item">
        <a href="/" class="pure-menu-link" ">Home</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="/blog.html" class="pure-menu-link" ">Blog</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="/projects.html" class="pure-menu-link" ">Projects</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="/presentations.html" class="pure-menu-link" ">Presentations</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="/contact.html" class="pure-menu-link" ">Contact</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="/pgp.html" class="pure-menu-link" ">PGP key</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="https://github.com/kobigurk" class="pure-menu-link" target="_blank"">GitHub</a>
			</li>
			
			<li class="pure-menu-item">
        <a href="https://twitter.com/kobigurk" class="pure-menu-link" target="_blank"">Twitter</a>
			</li>
			
		</ul>
	</div>
</div>

			<div id="main">
				<div class="header">
					<h3>Phishing in the age of preview</h3>
				</div>
				<div class="content">
					<p>07 Apr 2017 - Kobi</p>

<p>Link previews are convenient. Implemented inside messaging platforms, they allow you to see the summary of a link a friend sent you without actually opening it, giving you the ability to decide whether it’s important or interesting enough to open it in a browser.</p>

<p>Consider the following situation: Your WhatsApp account has been hacked. The hacker goes through your contacts list and message history, finding out who are your the people you’re conversing with the most. Then, the hacker prepares a malicious web-site - the web-site installs some malware that steals your bank account password once you go into it. The hacker even makes the web-site have a nice preview about a subject you’re discussing with your friend often, so your friend would think it’s a legitimate web-site. The friend, not knowing he’s talking with a hacker rather than his good friend, opens the link and gets infected!</p>

<p>This may sound unrealistic - a messaging account getting hacked, but it happened to a colleague of mine in <a href="http://qed-it.com">QED-it</a>. His Skype account got hacked and started distributing suspicious links to some of his contacts. Apparently, it was quite successful, as some of these contacts got hacked as well and sent him suspicious links back.</p>

<p>So while it’s a multi-step phishing attack, once you get hold of a social media or messaging account, if you can construct believable links, it should be pretty easy to infect your contacts.</p>

<p>#Wait, what?</p>

<p>You must think - “well, this guy is crazy, it’s not that easy creating these links”. Is it really that easy to construct believable previews? Apparently yes! All you have to do is implement the <a href="http://ogp.me/">Open Graph Protocol</a> on your web-page. This is a description of the Open Graph protocol, in their words:</p>
<blockquote>
  <p>The Open Graph protocol enables any web page to become a rich object in a social graph. For instance, this is used on Facebook to allow any web page to have the same functionality as any other object on Facebook.</p>
</blockquote>

<p>Many of the messaging platforms support it - an incomplete list includes Facebook, WhatsApp and Telegram.</p>

<p>In order to have a preview for your web-site, you just need to add this prefix to the <code class="highlighter-rouge">html</code> tag and these properties to your <code class="highlighter-rouge">head</code> section:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html</span> <span class="na">prefix=</span><span class="s">"og: http://ogp.me/ns#"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span> 
        <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:title"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:site_name"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:image"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:url"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">property=</span><span class="s">"og:description"</span> <span class="na">content=</span><span class="s">""</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<p>That’s it. The hacker can now insert whatever code he wants, even a redirect to another web-site.</p>

<p>Another component which may be useful in order to mask the fact it’s a malicious URL would be a URL shortener such as <a href="http://bit.ly">bit.ly</a>.</p>

<p>#Meh, that’s a bit of work
Well, then you can just use <a href="http://roll.kobigurk.com/generator.html">my tool</a> to generate an auto-redirecting malicious URL shortened by bit.ly.</p>

<p><img src="/content/images/2017/04/Untitled.png" alt="TPaaS" /></p>

<p>Now, that’s really easy…</p>

<p>This, <a href="http://bit.ly/2oCoEeY">http://bit.ly/2oCoEeY</a> , is a link that has a preview exactly like a real BBC article, but actually rick-rolls you (advantage if you like Rick Astley music videos!). This is its preview as it’s rendered on Telegram:
<img src="/content/images/2017/04/Untitled-1.png" alt="TelegramExample" /></p>

<p>#What can we do?
Good question. It’s always an interactive game - put a barrier, hackers get through and so on. But, in my feeling, there’s a lot of room for improvement regarding these previews.</p>

<p>Facebook, for example, does a better job than the rest:</p>
<ol>
  <li>If a URL is given in the <code class="highlighter-rouge">og:url</code> tag, that one is eventually used to retrieve the others.</li>
  <li>If a URL is not given or invalid, then the actual URL is displayed under the post.</li>
</ol>

<p>In Telegram and WhatsApp, this is not the case - you completely control the content that is shown to the user.</p>

<p>So, to begin with, sites can show the actual URL being used to retrieve the tags.</p>

<p>A different direction I’ve been considering is similar to the HTTPS user experience existing in most major browsers:</p>
<ol>
  <li>If the URL is not authenticated (HTTP), show a message that says “this preview is not secure”.</li>
  <li>If the URL is from an HTTPS link, show the Common Name in the certificate.</li>
</ol>

<p>These details alone would make the situation much better.</p>

<p>#To summarize…
Link previews are nice and fun, but may also be used as a convenient tool to improve phishing campaigns considerably. I believe there are solutions to make it better and some platforms are realizing this and taking steps, but there’s more work to do.</p>

<p>Hopefully we can combine the easiness and convenience with security!</p>




<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://EXAMPLE.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            


				</div>
			</div>
    </div>
		<script type="text/javascript" src="/assets/js/ui.js"></script>
    
    <script type="text/javascript" src="/assets/MathJax-2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
		<script src="/assets/js/solidity.js"></script>
    <script type="text/javascript">
      hljs.registerLanguage('solidity', window.hljsDefineSolidity);
      hljs.initHighlightingOnLoad();
    </script>
    <script type="text/javascript">window.$crisp=[];window.CRISP_WEBSITE_ID="89b86248-82d0-4a4a-8fd3-59a0088b1ffa";(function(){d=document;s=d.createElement("script");s.src="https://client.crisp.chat/l.js";s.async=1;d.getElementsByTagName("head")[0].appendChild(s);})();</script>
  </body>
</html>
